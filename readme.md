# Лабораторная работа: Создание PHP приложения на базе двух контейнеров: nginx и php-fpm

## Цель работы
Целью данной работы является освоение взаимодействия нескольких Docker-контейнеров. Студент научится настраивать и запускать два контейнера: один для работы с веб-сервером Nginx, а другой для обработки PHP запросов с использованием PHP-FPM.

## Задание
1. Создать PHP приложение, используя два контейнера: nginx и php-fpm.
2. Настроить взаимодействие этих контейнеров через Docker.
3. Проверить работоспособность приложения через браузер, убедившись в корректной работе PHP-страниц.

## Описание выполнения работы с ответами на вопросы

1. **Создание репозитория и файлов**
   - Создали репозиторий **containers06** и клонировали его на локальный компьютер.
   - В директории **containers06** создали поддиректорию **mounts/site**, куда перенесли PHP-сайт.
   - Создали файл **.gitignore**, чтобы исключить файлы из директории **mounts/site** от коммитов в репозиторий.
   
2. **Создание конфигурации для Nginx**
   - Создали файл конфигурации **nginx/default.conf**, в котором указали настройки для Nginx, включая проброс PHP-запросов на контейнер с PHP-FPM.
   Создайте в директории containers05 файл nginx/default.conf со следующим содержимым:
```nginx
server {
    listen 80;
    server_name _;
    root /var/www/html;
    index index.php;
    
    location / {
        try_files $uri $uri/ /index.php?$args;
    }

    location ~ \.php$ {
        fastcgi_pass backend:9000;
        fastcgi_index index.php;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        include fastcgi_params;
    }
}
```
![image](https://github.com/user-attachments/assets/60bdfb07-2ecf-4ddc-a23c-64b4c4ae2b69)


3. **Создание Docker-контейнеров**
   - Создан контейнер **backend** на базе образа **php:7.4-fpm**, где монтируется директория **mounts/site** для хранения PHP-файлов.
   - Создан контейнер **frontend** на базе образа **nginx:1.23-alpine**, с настройками для работы с PHP через **nginx/default.conf**.
   - Оба контейнера работают в одной сети **internal**, что позволяет им обмениваться данными.

![image](https://github.com/user-attachments/assets/632ab523-226b-4809-81e3-3ffada5769b0)
![image](https://github.com/user-attachments/assets/cfa1c072-17e3-4f54-be28-a28f5df5d558)


4. **Запуск и проверка работы**
   - Контейнеры были запущены командой `docker-compose up -d`.
   - После запуска проверили доступность сайта через браузер по адресу **http://localhost**. При первом отображении базовой страницы Nginx, после обновления страницы появилась страница с сообщением "Hello, Docker!".
   
![image](https://github.com/user-attachments/assets/30532d0c-3a21-4a94-9521-0eb30495026c)

## Ответы на вопросы

1. **Каким образом в данном примере контейнеры могут взаимодействовать друг с другом?**
   - Контейнеры могут взаимодействовать через созданную сеть **internal**, где контейнер **frontend** обращается к контейнеру **backend** через имя **backend**.

2. **Как видят контейнеры друг друга в рамках сети internal?**
   - В рамках сети **internal** контейнеры видят друг друга по именам контейнеров. Например, контейнер **frontend** использует имя **backend** для обращения к контейнеру с PHP-FPM.

3. **Почему необходимо было переопределять конфигурацию nginx?**
   - Переопределение конфигурации Nginx необходимо для того, чтобы указать правильные параметры для обработки PHP-запросов и настройки корневой директории веб-сервера.

## Выводы
1. Успешно настроил взаимодействие двух контейнеров через Docker.
2. Использование Docker-сетей позволило изолировать контейнеры, но сохранить возможность их взаимодействия.
3. Переопределение конфигурации Nginx было необходимым для корректной работы PHP через контейнер с PHP-FPM.


